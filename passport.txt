1. npm install passport
2. npm install express-session
3. npm install passport-google-oauth20
3. --server.js--
const session = require('express-session')
const passport = require('passport')

require('./passport')(passport);
.use(session({
    secret: 'keyboard cat',
    cookie: {
      maxAge: 60000 * 60 * 24, //1Sec * 1H * 24 = 1 Day
      
  },
  resave: true,
  saveUninitialized: true,
    
  }))
//Passport
.use(passport.initialize())
.use(passport.authenticate('session'))
.use('/auth', require('./routes/auth'))


4.-- .env--

GOOGLE_CLIENT_ID

GOOGLE_CLIENT_SECRET

https://console.cloud.google.com
select project -> new project -> select project -> 
navigation menu MORE PRODUCTS APIs & Services -> OAuth consent screen 
->
Credentials -> Create Credentials 
(WEB CLIENT 1
Authorized redirect URIs
http://localhost:7070/auth/google/callback)




5. --passport.js--
const dotenv = require('dotenv');
dotenv.config();
const GoogleStrategy = require('passport-google-oauth20').Strategy;





const { MongoClient } = require('mongodb');

module.exports = function(passport){
    passport.use(
        new GoogleStrategy(
            {
                clientID: process.env.GOOGLE_CLIENT_ID,
                clientSecret: process.env.GOOGLE_CLIENT_SECRET,
                callbackURL: '/auth/google/callback'
    }
    ,
    async (accessToken, refreshToken, profile, done) => {
        //console.log(profile)
    try{
         done(null, profile)
    }
    catch(err){
        console.log(err)
    }
    
}))
   
      
    passport.serializeUser(function(user, done) {
        process.nextTick(function() {
         return done(null, { id: user.id, username: user.name, name: user.displayName });
        });
      });
      
      passport.deserializeUser(function(user, done) {
        process.nextTick(function() {
          return done(null, user);
        });
      });
}

6. --routes/auth.js--

const passport = require('passport');
const { getPlanets } = require('../controllers');

const route = require ('express').Router();

route.get('/google', passport.authenticate('google', { scope: ['profile'] }));
route.get('/google/callback', passport.authenticate('google'),(req,res) => {
    res.redirect('/api-docs');
});
route.get('/logout',(req,res)=>{
    req.logout(function(err) {
        if (err) { return next(err); };
    res.redirect('/planets/loginView');
    })})


module.exports = route;